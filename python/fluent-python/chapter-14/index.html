<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Chapter 14 | Dongseok Kim</title> <meta name="author" content="Dongseok Kim"> <meta name="description" content="Inheritance For Better or For Worse"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/atom-one-light.min.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/atom-one-dark.min.css" media="none" id="highlight_theme_dark"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://d0ngse0kkim.github.io/python/fluent-python/chapter-14/"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Chapter 14",
      "description": "Inheritance For Better or For Worse",
      "published": "February 3, 2024",
      "authors": [
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">DongseokÂ </span>Kim</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programming</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/python">Python</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/softwaredesign/">Software Design</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/tools/">Tools</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">hobbies</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/running">running</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">others</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/repositories">repositories</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/cv/">cv</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Chapter 14</h1> <p>Inheritance For Better or For Worse</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#abstract">Abstract</a></div> <div><a href="#the-super-function">The Super Function</a></div> <div><a href="#subclassing-built-in-types-is-tricky">Subclassing Built-In Types Is Tricky</a></div> <div><a href="#multiple-inheritance-and-method-resolution-order">Multiple Inheritance and Method Resolution Order</a></div> <div><a href="#method-resolution-order">Method Resolution Order</a></div> <div><a href="#mixin-classes">Mixin Classes</a></div> <div><a href="#multiple-inheritance-in-the-real-world">Multiple Inheritance in the Real World</a></div> <div><a href="#coping-with-inheritance">Coping with Inheritance</a></div> <div><a href="#chapter-summary">Chapter Summary</a></div> <div><a href="#links">Links</a></div> </nav> </d-contents> <h2 id="abstract">Abstract</h2> <p>This is a summary of chapter 14 of <a href="https://www.oreilly.com/library/view/fluent-python-2nd/9781492056348/" rel="external nofollow noopener" target="_blank">Fluent Python</a>. This chapter provides an overview of inheritance and tips for inheritance in Python.</p> <h2 id="the-super-function">The <code>super()</code> Function</h2> <p><code>super()</code><sup id="fnref:pythonorg__builtinfunctions_super" role="doc-noteref"><a href="#fn:pythonorg__builtinfunctions_super" class="footnote" rel="footnote">1</a></sup> is a function used to access the superclass of an object.</p> <h3 id="recommendation-of-the-super-function"><em>Recommendation of the <code>super()</code> function</em></h3> <p>There are two options to use properties or object methods of superclass:</p> <ol> <li>calling the name of the superclass explicitly : <code>SuperClassName.init_this_object()</code> or <code>SuperClassName.property</code>.</li> <li>calling the built-in function <code>super()</code> : <code>super().init_this_class()</code> or <code>super().property</code>.</li> </ol> <p>There are two reasons why it is recommended to use <code>super()</code> instead of calling the name of the superclass explicitly:</p> <ol> <li>It can cause a bug if the class inheritance relationships are changed.</li> <li>The method <code>super()</code> implements logic to handle class hierarchies with multiple inheritance.</li> </ol> <p>Consistent use of the <code>super()</code> built-in function is essential for building maintainable object-oriented Python programs.</p> <p>To build maintainable object-oriented programs, it is recommended to use the <code>super()</code> built-in functions for expanding a existing method of the superclass.</p> <p>In the following example codes, dictionary with order between each dictionary key-value pairs is implemented by subclassing existing class <sup id="fnref:pythonorg__colletions_ordereddict" role="doc-noteref"><a href="#fn:pythonorg__colletions_ordereddict" class="footnote" rel="footnote">2</a></sup> and using the existing methods of superclass <sup id="fnref:pythonorg__colletions_ordereddict_move_to_end" role="doc-noteref"><a href="#fn:pythonorg__colletions_ordereddict_move_to_end" class="footnote" rel="footnote">3</a></sup>:</p> <p>For example, in the class <code>FIFOOrderedDict</code> in the following example codes, you can use <code>super()</code> to inherit and call methods from the parent class.</p> <p>However, it is not recommended to use the name of the superclass directly in the subclass, as shown in the class <code>NotRecommendedFIFOOrderedDict</code> in the following example code.</p> <pre><code class="language-python">class FIFOOrderedDict(OrderedDict):
    def __setitem__(self, key, value):
        super().__setitem__(key, value)
        self.move_to_end(key)

class NotRecommendedFIFOOrderedDict(OrderedDict):
    def __setitem__(self, key, value):
        OrderedDict.__setitem__(self, key, value)
        self.move_to_end(key)
</code></pre> <h3 id="arguments-for-the-super-function"><em>Arguments for the <code>super()</code> function</em></h3> <p><code>super()</code> can accepts two arguments for its calling.</p> <dl> <dt>1st Argument - <code>type</code> </dt> <dd>The starting class of the search path for the superclass implementing the desired method. By default, the class of the method which calls the <code>super()</code> built-in method is specified.</dd> <dt>2nd Argument - <code>object_or_type</code> </dt> <dd>The object (for instance method calls) or class (for class method calls with <code>@classmethod</code>) must be specified for this argument. By default, <code>self</code> is specified when calling the <code>super()</code> method in an instance method.</dd> </dl> <p>These arguments can be omitted. The equivalant of the statement <code>super().__setitem__(key, value)</code> in the <code>__setitem__()</code> method can be written like this.</p> <pre><code class="language-python">class FIFOOrderedDict(OrderedDict):
    def __setitem__(self, key, value):
        super(FIFOOrderedDict, self).__setitem__(key, value)
        self.move_to_end(key)
</code></pre> <p>The <code>super()</code> call returns a dynamic proxy object that finds a specified method (<code>__setitem__</code> for the above example) in a superclass of the <code>type</code> parameter.</p> <p>In Python 3, it is possible to specify the first and second arguments when calling <code>super()</code>, but this is only necessary in special cases such as skipping the method resolution order for debugging purpose.</p> <h2 id="subclassing-built-in-types-is-tricky">Subclassing Built-In Types Is Tricky</h2> <p>It is possible to subclass built-in types such as <code>list</code> or <code>dict</code> in Python 2.2 or later. When subclassing built-in types, it should be considered that the code of the built-ins (written in C) may <strong>not call methods overriden by user-defined classes</strong>.</p> <p>In the following example, The overrided <code>__setitem__</code> method are ignored in <code>dd.update()</code> of built-in <code>dict</code> class.</p> <pre><code class="language-python">&gt;&gt;&gt; class DoppelDict(dict):
...     def __setitem__(self, key, value):
...         super().__setitem__(key, [value] * 2)
...
&gt;&gt;&gt; dd = DoppelDict(one=1)
&gt;&gt;&gt; dd
{'one': 1}
&gt;&gt;&gt; dd['two'] = 2
&gt;&gt;&gt; dd
{'one': 1, 'two': [2, 2]}
&gt;&gt;&gt; dd.update(three=3)
&gt;&gt;&gt; dd
{'three': 3, 'one': 1, 'two': [2, 2]}
</code></pre> <p>In the following example, the overrided <code>__getitem__</code> are ignored in the following codes which uses built-in implementation.</p> <ol> <li> <code>dd = DoppelDict(one=1)</code> : When initialization of class object, <br> setting new pairs must used the overridden <code>__setitem__()</code> methods.</li> <li> <code>d.update()</code> : built-in object methods which uses <code>__setitem__()</code> </li> </ol> <pre><code class="language-python">&gt;&gt;&gt; class AnswerDict(dict):
...     def __getitem__(self, key):
...         return 42
...
&gt;&gt;&gt; ad = AnswerDict(a='foo')
&gt;&gt;&gt; ad['a']
42
&gt;&gt;&gt; d = {}
&gt;&gt;&gt; d.update(ad)
&gt;&gt;&gt; d['a']
'foo'
&gt;&gt;&gt; d
{'a': 'foo'}
</code></pre> <p>This behavior(Result of <code>d.update(ad)</code>) in built-in types violates a basic rule of object-oriented programming called âlate bindingâ:</p> <p>The search for methods should always start from the class of the receiver (<code>self</code>), even when the call happens inside a method implemented in a superclass.</p> <p>To correct this behavior, one can subclass <code>collections.UserDict</code>. Subclassing a base class coded in Python, like <code>UserDict</code> or <code>MutableMapping</code>, will prevent any related issues.</p> <pre><code class="language-python">&gt;&gt;&gt; import collections
&gt;&gt;&gt;
&gt;&gt;&gt; class DoppelDict2(collections.UserDict):
...     def __setitem__(self, key, value):
...         super().__setitem__(key, [value] * 2)
...
&gt;&gt;&gt; dd = DoppelDict2(one=1)
&gt;&gt;&gt; dd {'one': [1, 1]}
&gt;&gt;&gt; dd['two'] = 2
&gt;&gt;&gt; dd
{'two': [2, 2], 'one': [1, 1]}
&gt;&gt;&gt; dd.update(three=3)
&gt;&gt;&gt; dd
{'two': [2, 2], 'three': [3, 3], 'one': [1, 1]}
&gt;&gt;&gt;
&gt;&gt;&gt; class AnswerDict2(collections.UserDict):
... def __getitem__(self, key):
...     return 42
...
&gt;&gt;&gt; ad = AnswerDict2(a='foo')
&gt;&gt;&gt; ad['a']
42
&gt;&gt;&gt; d = {}
&gt;&gt;&gt; d.update(ad)
&gt;&gt;&gt; d['a']
42
&gt;&gt;&gt; d
{'a': 42}
</code></pre> <h2 id="multiple-inheritance-and-method-resolution-order">Multiple Inheritance and Method Resolution Order</h2> <p>In this chapter, the class <code>Root</code>, <code>A</code>, <code>B</code> and <code>Leaf</code> with complex multiple inheritance will be discussed to describe the method resolution order with complex class inheritance.</p> <p>Any programming language implementing multiple inheritance must resolve potential naming conflicts when superclasses implement a method with the same name.</p> <p>In the following example, the complex inheritance hierarchy, which is hard to deal with, called the âdiamond problemâ, will be discussed.</p> <h3 id="uml-diagrams-in-the-diamond-problem"><em>UML Diagrams in the âDiamond Problemâ</em></h3> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/python/fluent-python/chapter-14/ping.svg-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/python/fluent-python/chapter-14/ping.svg-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/python/fluent-python/chapter-14/ping.svg-1400.webp"></source> <img src="/python/fluent-python/chapter-14/ping.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture><figcaption class="caption">The Red Arrows represent the method resolution order of the ping method.</figcaption> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/python/fluent-python/chapter-14/pong.svg-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/python/fluent-python/chapter-14/pong.svg-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/python/fluent-python/chapter-14/pong.svg-1400.webp"></source> <img src="/python/fluent-python/chapter-14/pong.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture><figcaption class="caption">The Red Arrows represent the method resolution order of the pong method. The pong method of Leaf class is inherited from the pong method in class A.</figcaption> </figure> </div> </div> <h3 id="source-codes"><em>Source codes</em></h3> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="cbd13885fc1a7903be433277791ff9d1868be752" path="14-inheritance/diamond.py" language="python" line="27-61"></div> <ul> <li> <code>&lt;1&gt;</code> : class <code>Root</code> provides the following methods. <ul> <li> <code>ping</code>, <code>pong</code> : methods overridden by classes <code>A</code>, <code>B</code>, and <code>Leaf</code>.</li> <li> <code>__repr__</code> : returns a descriptive string that indicates which class executed the method.</li> </ul> </li> <li> <code>&lt;2&gt;</code> : class <code>A</code> provides the following methods. <ul> <li> <code>ping</code>, <code>pong</code> : methods overrides the <code>ping</code> and <code>pong</code> method in class <code>Root</code>. In these methods, the superclass method will be executed using <code>super()</code>.</li> </ul> </li> <li> <code>&lt;3&gt;</code> : class <code>B</code> provides the following methods. <ul> <li> <code>ping</code>, <code>pong</code> : methods overrides the <code>ping</code> and <code>pong</code> method in class <code>Root</code>. In <code>ping</code> method, the <code>ping</code> method of superclass will be executed using <code>super()</code>.</li> </ul> </li> <li> <code>&lt;4&gt;</code> : class <code>Leaf</code> inherits classes <code>A</code> and <code>B</code>, and provides a following method. <ul> <li> <code>ping</code> : methods overrides the <code>ping</code> and <code>pong</code> method in classes <code>Root</code>, <code>A</code>, and <code>B</code>. In <code>ping</code> method, the <code>ping</code> method of superclass will be executed using <code>super()</code>.</li> </ul> </li> </ul> <h3 id="ping-method-resolution-order"><em><code>ping</code> Method resolution order</em></h3> <pre><code class="language-python">&gt;&gt;&gt; leaf1 = Leaf()
&gt;&gt;&gt; leaf1.ping()
&lt;instance of Leaf&gt;.ping() in Leaf
&lt;instance of Leaf&gt;.ping() in A
&lt;instance of Leaf&gt;.ping() in B
&lt;instance of Leaf&gt;.ping() in Root
</code></pre> <p>Results of <code>leaf1.ping()</code> represent methods resolution order of the red arrow in the figures above and to the left.</p> <h3 id="pong-method-resolution-order"><em><code>pong</code> Method resolution order</em></h3> <pre><code>&gt;&gt;&gt; leaf1.pong()
&lt;instance of Leaf&gt;.pong() in A
&lt;instance of Leaf&gt;.pong() in B
</code></pre> <p>Results of <code>leaf1.pong()</code> represent methods resolution order of the red arrow in the figures above and to the right.</p> <h2 id="method-resolution-order"><em>Method Resolution Order</em></h2> <h3 id="method-resolution-order-of-the-class-leaf"><em>Method Resolution Order of the class <code>Leaf</code></em></h3> <p>The MRO (Method Resolution Order) is computed using the C3 algorithm described in this article <sup id="fnref:blog__c3_method_resolution_order" role="doc-noteref"><a href="#fn:blog__c3_method_resolution_order" class="footnote" rel="footnote">4</a></sup>.</p> <p>By using the C3 algorithm, the MRO of class <code>Leaf</code> can be computed using the following equations.</p> <table> <thead> <tr> <th>Class Name</th> <th>Class Representation</th> <th>Linearization Representation</th> </tr> </thead> <tbody> <tr> <td><code>object</code></td> <td>Italic Letter $O$</td> <td>$L[O]$</td> </tr> <tr> <td><code>Root</code></td> <td>The Non-italic Letter $\textrm{R}$</td> <td>$L[\textrm{R}]$ or $L[\textrm{R}(O)]$</td> </tr> <tr> <td><code>A</code></td> <td>Italic Letter $A$</td> <td>$L[A]$ or $L[A(\textrm{R})]$</td> </tr> <tr> <td><code>B</code></td> <td>Italic Letter $B$</td> <td>$L[B]$ or $L[B(\textrm{R})]$</td> </tr> <tr> <td><code>Leaf</code></td> <td>$\textrm{L}$</td> <td>$L[\textrm{L}]$ or $L[\textrm{L}(A\;B)]$</td> </tr> </tbody> </table> \[\begin{split} L[\textrm{R}] = L[\textrm{R}(O)] &amp;= \textrm{R} + merge(L[O],\;O) \\ &amp;= \textrm{R} + merge(O,\;O) \\ &amp;= \textrm{R}O\\ &amp;\\ L[A] = L[A(\textrm{R})] &amp;= A + merge(L[\textrm{R}],\;\textrm{R}) \\ &amp;= A + merge(\textrm{R}O,\;\textrm{R}) \\ &amp;= A\textrm{R} + merge(O) \\ &amp;= A\textrm{R}O\\ &amp;\\ L[B] = L[B(\textrm{R})] &amp;= B + merge(L[\textrm{R}],\;\textrm{R}) \\ &amp;= B + merge(\textrm{R}O,\;\textrm{R}) \\ &amp;= B\textrm{R} + merge(O) \\ &amp;= B\textrm{R}O\\ &amp;\\ L[\textrm{L}] = L[\textrm{L}(A\;B)] &amp;= \textrm{L} + merge(L[A],\;L[B],\;AB)\\ &amp;= \textrm{L} + merge(A\textrm{R}O,\;B\textrm{R}O,\;AB)\\ &amp;= \textrm{L}A + merge(\textrm{R}O,\;B\textrm{R}O,\;B)\\ &amp;= \textrm{L}AB + merge(\textrm{R}O,\;\textrm{R}O)\\ &amp;= \textrm{L}AB\textrm{R} + merge(O,\;O)\\ &amp;= \textrm{L}AB\textrm{R}O \end{split}\] <p>Therefore, the linearization(Method resolution order) of class <code>Leaf</code> is derived as $\textrm{L}AB\textrm{R}O$ by the C3 algorithm.</p> <p>The same result is also obtained from the <code>Leaf.__mro__</code>.</p> <pre><code class="language-python">&gt;&gt;&gt; Leaf.__mro__
(
    &lt;class '__main__.Leaf'&gt;, &lt;class '__main__.A'&gt;,
    &lt;class '__main__.B'&gt;, &lt;class '__main__.Root'&gt;,
    &lt;class 'object'&gt;
)
</code></pre> <h3 id="the-roles-of-the-method-resolution-order"><em>The Roles of the Method Resolution Order</em></h3> <p>The MRO determines the activation order of a method that has an implementation that calls <code>super()</code>.</p> <p>Consider the experiment with the <code>pong</code> method. The <code>Leaf</code> class does not override it; therefore, calling <code>leaf1.pong()</code> activates the implementation in the <code>A</code> class, which is the next class in <code>Leaf.__mro__</code>.</p> <p>The method <code>A.pong()</code> calls <code>super().pong()</code>. This calls the implementation in the <code>B</code> class, which is next in the MRO. Therefore, <code>B.pong()</code> is activated.</p> <p>The <code>B.pong()</code> method doesnât call <code>super().pong()</code>, so the activation sequence ends here.</p> <h3 id="cooperative-method"><em>Cooperative Method</em></h3> <p><em>Cooperative method</em> is a method calls <code>super()</code>. Cooperative methods enable <em>cooperative multiple inheritance</em>. In order to work, multiple inheritance in Python requires the active cooperation of the methods involved. For example, In the <code>B</code> class, <code>ping</code> cooperates, but <code>pong</code> does not.</p> <p>A non-cooperative method can be the cause of subtle bugs. It is expected that when the method <code>A.pong</code> calls <code>super.pong()</code>, it will ultimately activate <code>Root.pong</code>. But if <code>B.pong</code> is activated before, the activation sequence ends here, which is not expected by many coders reading this example. Thatâs why it is recommended that every method <code>m</code> of a nonroot class should call <code>super().m()</code>.</p> <h3 id="dynamic-aspect-of-method-resolution-order"><em>Dynamic Aspect of Method Resolution Order</em></h3> <p>Python is a dynamic language, so interaction of <code>super()</code> with the MRO is also dynamic.</p> <p>In the following example, the MRO related to class <code>A</code> is determined dynamically by the inheritance relationship.</p> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="cbd13885fc1a7903be433277791ff9d1868be752" path="14-inheritance/diamond2.py" language="python" line="50-66"></div> <details><summary>Details of class A</summary> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="cbd13885fc1a7903be433277791ff9d1868be752" path="14-inheritance/diamond.py" language="python" line="27-46"></div> </details> <p></p> <h4 id="the-mro-of-each-classes"><em>The MRO of Each Classes</em></h4> <p>Letâs introduce the following representation:</p> <table> <thead> <tr> <th>Class Name</th> <th>Class Representation</th> <th>Linearization Representation</th> </tr> </thead> <tbody> <tr> <td><code>object</code></td> <td>Italic Letter $O$</td> <td>$L[O]$</td> </tr> <tr> <td><code>Root</code></td> <td>The Non-italic Letter $\textrm{R}$</td> <td>$L[\textrm{R}]$ or $L[\textrm{R}(O)]$</td> </tr> <tr> <td><code>A</code></td> <td>Italic Letter $A$</td> <td>$L[A]$ or $L[A(\textrm{R})]$</td> </tr> <tr> <td><code>U</code></td> <td>Italic Letter $U$</td> <td>$L[U]$ or $L[U(O)]$</td> </tr> <tr> <td><code>LeafUA</code></td> <td>$\textrm{L}_{UA}$</td> <td>\(L[\textrm{L}_{UA}]\) or \(L[\textrm{L}_{UA}(U\;A)]\)</td> </tr> <tr> <td><code>LeafAU</code></td> <td>$\textrm{L}_{AU}$</td> <td>\(L[\textrm{L}_{AU}]\) or \(L[\textrm{L}_{AU}(A\;U)]\)</td> </tr> </tbody> </table> <p>Then, the linearization of each classes is represented by the following equations.</p> \[\begin{split} L[\textrm{R}] = L[\textrm{R}(O)] &amp;= \textrm{R} + merge(L[O],\;O) \\ &amp;= \textrm{R} + merge(O,\;O) \\ &amp;= \textrm{R}O\\ &amp;\\ L[A] = L[A(\textrm{R})] &amp;= A + merge(L[\textrm{R}],\;\textrm{R}) \\ &amp;= A + merge(\textrm{R}O,\;\textrm{R}) \\ &amp;= A\textrm{R} + merge(O) \\ &amp;= A\textrm{R}O\\ &amp;\\ L[U] = L[U(O)] &amp;= U + merge(L[O], O)\\ &amp;= U + merge(O, O)\\ &amp;= UO\\ &amp;\\ L[\textrm{L}_{UA}] = L[\textrm{L}_{UA}(U\;A)] &amp;= \textrm{L}_{UA} + merge(L[U],\;L[A],\;UA)\\ &amp;= \textrm{L}_{UA} + merge(UO,\;A\textrm{R}O,\;UA)\\ &amp;= \textrm{L}_{UA}U + merge(O,\;A\textrm{R}O,\;A)\\ &amp;= \textrm{L}_{UA}UA + merge(O,\;\textrm{R}O)\\ &amp;= \textrm{L}_{UA}UA\textrm{R} + merge(O,\;O)\\ &amp;= \textrm{L}_{UA}UA\textrm{R}O\\ &amp;\\ L[\textrm{L}_{AU}] = L[\textrm{L}_{AU}(A\;U)] &amp;= \textrm{L}_{AU} + merge(L[A],\;L[U],\;AU)\\ &amp;= \textrm{L}_{AU} + merge(A\textrm{R}O,\;UO,\;AU)\\ &amp;= \textrm{L}_{AU}A + merge(\textrm{R}O,\;UO,\;U)\\ &amp;= \textrm{L}_{AU}A\textrm{R} + merge(O,\;UO,\;U)\\ &amp;= \textrm{L}_{AU}A\textrm{R}U + merge(O,\;O)\\ &amp;= \textrm{L}_{AU}A\textrm{R}UO \end{split}\] <p>These results can be checked by the <code>__mro__</code> properties of each classes.</p> <pre><code class="language-python">&gt;&gt;&gt; Root.__mro__
(&lt;class '__main__.Root'&gt;, &lt;class 'object'&gt;)
&gt;&gt;&gt; A.__mro__
(
    &lt;class '__main__.A'&gt;, &lt;class '__main__.Root'&gt;,
    &lt;class 'object'&gt;
)
&gt;&gt;&gt; U.__mro__
(&lt;class '__main__.U'&gt;, &lt;class 'object'&gt;)
&gt;&gt;&gt; LeafUA.__mro__
(
    &lt;class '__main__.LeafUA'&gt;, &lt;class '__main__.U'&gt;,
    &lt;class '__main__.A'&gt;, &lt;class '__main__.Root'&gt;,
    &lt;class 'object'&gt;
)
&gt;&gt;&gt; LeafAU.__mro__
(
    &lt;class '__main__.LeafAU'&gt;, &lt;class '__main__.A'&gt;,
    &lt;class '__main__.Root'&gt;, &lt;class '__main__.U'&gt;,
    &lt;class 'object'&gt;
)
</code></pre> <h4 id="results-of-superping-method-of-class-u"><em>Results of <code>super().ping()</code> Method of class <code>U</code></em></h4> <p>The <code>AttributeError</code> is raised when using the <code>ping</code> method of class <code>U</code> because the <code>U.__mro__</code> is set to <code>(&lt;class 'U'&gt;, &lt;class 'object'&gt;)</code>, which means $L[U] = UO$. This means that the superclass of class <code>U</code> is <code>object</code>, which does not have a <code>ping</code> method.</p> <pre><code class="language-python">&gt;&gt;&gt; u = U()
&gt;&gt;&gt; u.ping()
&lt;__main__.U object at 0x102f0ca10&gt;.ping() in U
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "&lt;stdin&gt;", line 4, in ping
AttributeError: 'super' object has no attribute 'ping'
</code></pre> <p>On the other hand, no exceptions is raised when using <code>ping</code> method over instances of the class <code>LeafUA</code> because the <code>LeafUA.__mro__</code> is set to <code>(&lt;class 'LeafUA'&gt;, &lt;class 'U'&gt;, &lt;class 'A'&gt;, &lt;class 'Root'&gt;, &lt;class 'object'&gt;)</code>. This means that the superclass of the class <code>U</code> in the MRO of the class <code>LeafUA</code> is <code>A</code>, which has a <code>ping</code> method. Therefore <code>AttributeError</code> is not raised in the following example.</p> <pre><code class="language-python">&gt;&gt;&gt; leaf2 = LeafUA()
&gt;&gt;&gt; leaf2.ping()
&lt;instance of LeafUA&gt;.ping() in LeafUA
&lt;instance of LeafUA&gt;.ping() in U
&lt;instance of LeafUA&gt;.ping() in A
&lt;instance of LeafUA&gt;.ping() in Root
</code></pre> <p>Finally, no exception is raised when using <code>ping</code> method on instances of the class <code>LeafAU</code> because the <code>leaf3.ping()</code> would never reach <code>U.ping()</code> method. This is because <code>Root.ping()</code> method does not call <code>super().ping()</code> method. In this case, the <code>LeafAU.__mro__</code> is set to <code>(&lt;class 'LeafAU'&gt;, &lt;class 'A'&gt;, &lt;class 'Root'&gt;, &lt;class 'U'&gt;, &lt;class 'object'&gt;)</code>. Instead of the superclass of the class <code>U</code> is <code>object</code>, no exception is raised because the <code>Root.ping()</code> method does not call the <code>super().ping()</code> method.</p> <pre><code class="language-python">&gt;&gt;&gt; leaf3 = LeafAU()
&gt;&gt;&gt; leaf3.ping()
&lt;instance of LeafAU&gt;.ping() in LeafAU
&lt;instance of LeafAU&gt;.ping() in A
&lt;instance of LeafAU&gt;.ping() in Root
</code></pre> <p>The class <code>U</code> in the above example can be called a <em>mixin class</em>. A mixin class is a class intended to be used together with other classes in multiple inheritance to provide additional functionality. Details of mixin classes will be described in the following chapter.</p> <h2 id="mixin-classes">Mixin Classes</h2> <p>A Mixin class is a class that does not provide all functionality for a concrete object but only adds the behavior of child or sibling classes. The mixin class is designed to be subclassed along with at least one other class in a multiple inheritance arrangement.</p> <h3 id="case-insensitive-mappings">Case-Insensitive Mappings</h3> <p>In the following example, a mixin class <code>UpperCaseMixin</code> that provides the functionality of case-insensitive access to a mapping with string keys will be described.</p> <h4 id="definition-of-uppercasemixin"><em>Definition of <code>UpperCaseMixin</code></em></h4> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="01e717b60a9a14bc1bca4bffd915f7ed2c637e5e" path="14-inheritance/uppermixin.py" language="python" line="112-131"></div> <ul> <li> <code>&lt;1&gt;</code> : This helper function tries to return <code>key.upper()</code> and if <code>key.upper()</code> property cannot be found and raises an <code>AttributeError</code>, this helper function returns the unchanged <code>key</code>.</li> <li> <code>&lt;2&gt;</code> : This <code>UpperCaseMixin</code> mixin class overrides several methods accessing <code>key</code> using the helper function <code>_upper()</code>. Every overriden method is using <code>super()</code> method for overriding the methods of other classes.</li> </ul> <h4 id="usage-of-uppercasemixin"><em>Usage of <code>UpperCaseMixin</code></em></h4> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="01e717b60a9a14bc1bca4bffd915f7ed2c637e5e" path="14-inheritance/uppermixin.py" language="python" line="135-139"></div> <ul> <li> <code>&lt;1&gt;</code> : <code>UpperDict</code> inherits <code>UpperCaseMixin</code> and <code>collections.UserDict</code> in that order because <code>UpperClassMixin</code> must override <code>__setitem__</code> and other methods, and in order to do this, <code>UpperClassMixin</code> must appear before <code>collection.UserDict</code>.</li> <li> <code>&lt;2&gt;</code> : <code>UpperCounter</code> inherits <code>UpperCaseMixin</code> and <code>collections.Counter</code> in that order, and the reason for the order of inheriting class is the same as before.</li> <li> <code>&lt;3&gt;</code> : Instead of <code>pass</code>, it is better to provide a docstring in the body of the class definition for improved readability.</li> </ul> <h4 id="demo-of-upperdict-and-uppercounter"><em>Demo of <code>UpperDict</code> and <code>UpperCounter</code></em></h4> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="01e717b60a9a14bc1bca4bffd915f7ed2c637e5e" path="14-inheritance/uppermixin.py" language="python" line="8-17"></div> <div class="embed-github-src" repo="fluentpython/example-code-2e" branch="01e717b60a9a14bc1bca4bffd915f7ed2c637e5e" path="14-inheritance/uppermixin.py" language="python" line="24-26"></div> <h2 id="multiple-inheritance-in-the-real-world">Multiple Inheritance in the Real World</h2> <p>In the <em>Design Patterns</em> book, there is the only example of multiple inheritance is the Adapter pattern. In Python, multiple inheritance is also not popular, but there are some important examples of it.</p> <h3 id="abcs-are-mixins-too">ABCs Are Mixins Too</h3> <p>Among the Python standard library, the <code>collections.abc</code> <sup id="fnref:pythonorg__collections_abc" role="doc-noteref"><a href="#fn:pythonorg__collections_abc" class="footnote" rel="footnote">5</a></sup> library frequently uses multiple inheritance.</p> <dl> <dt>Definition of <em>Mixin methods</em> </dt> <dd> <em>Mixin methods</em> in the official documentation of <code>collections.abc</code> <sup id="fnref:pythonorg__collections_abc:1" role="doc-noteref"><a href="#fn:pythonorg__collections_abc" class="footnote" rel="footnote">5</a></sup> means concrete methods implemented in the collection ABCs. The following descriptions are the roles of mixin methods: <ol> <li>The mixin methods defines interfaces of collection ABCs.</li> <li>The mixin methods plays a role as mixin classes. <ul> <li>For example, the implementation of <code>collections.UserDict</code> <sup id="fnref:github__implementation_userdict" role="doc-noteref"><a href="#fn:github__implementation_userdict" class="footnote" rel="footnote">6</a></sup> uses <code>update</code> method that is a mixin method of <code>collections.abc.MutableMapping</code>.</li> </ul> </li> </ol> </dd> </dl> <h3 id="threadingmixin-and-forkingmixin">ThreadingMixIn and ForkingMixIn</h3> <p>The <code>http.server</code> package<sup id="fnref:pythonorg__http_server" role="doc-noteref"><a href="#fn:pythonorg__http_server" class="footnote" rel="footnote">7</a></sup> provides <code>HTTPServer</code> and <code>ThreadingHTTPServer</code> class.</p> <dl> <dt> <em><code>class</code></em> <code>http.server.ThreadingHTTPServer(server_address, RequestHandlerClass)</code> </dt> <dd>This class is identical to <code>HTTPServer</code> but uses threads to handle requests by using the <code>ThreadingMixIn</code>. This is useful to handle web browsers pre-opening sockets, on which <code>HTTPServer</code> would wait indefinitely.</dd> </dl> <p>This class is generated by inheriting <code>ThreadingMixIn</code> and <code>HTTPServer</code>.</p> <div class="embed-github-src" repo="python/cpython" branch="17c23167942498296f0bdfffe52e72d53d66d693" path="Lib/http/server.py" language="python" line="144-145"></div> <p>To provide functionality that handles each request in a new thread, the class <code>ThreadMixIn</code> defines three methods in the following codes.</p> <div class="embed-github-src" repo="python/cpython" branch="17c23167942498296f0bdfffe52e72d53d66d693" path="Lib/socketserver.py" language="python" line="664-701"></div> <ul> <li> <code>process_request_thread</code> : This method does not call <code>super()</code> because it is a new method for handling requests in a new thread, not an override. This implementation calls three instance methods that <code>HTTPServer</code> provides or other inheriting classes.</li> <li> <code>process_request</code> : This method does not call <code>super()</code> because it is also a new method for handling requests in a new thread. This function starts a new thread to process the request.</li> <li> <code>server_close</code> : This method calls <code>super().server_close()</code> to stop taking requests, and then wait for stopping the threads to stop using <code>self._threads.join()</code>.</li> </ul> <div class="embed-github-src" repo="python/cpython" branch="17c23167942498296f0bdfffe52e72d53d66d693" path="Lib/socketserver.py" language="python" line="542-552"></div> <p>The above code is part of the <code>ForkingMixIn</code> class. <code>ForkingMixIn</code> is a mixin class that provides functionality to support concurrent servers based on <code>os.fork()</code><sup id="fnref:pythonorg__os_fork" role="doc-noteref"><a href="#fn:pythonorg__os_fork" class="footnote" rel="footnote">8</a></sup>. This mixin class can be used similarly to <code>ThreadingMixIn</code>.</p> <h3 id="django-generic-views-mixins">Django Generic Views Mixins</h3> <p>In Django, class-based views were introduced in Django 1.3. The following classes are examples of classes that inherit mixin classes for implementing required functionality.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/python/fluent-python/chapter-14/django_view.svg-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/python/fluent-python/chapter-14/django_view.svg-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/python/fluent-python/chapter-14/django_view.svg-1400.webp"></source> <img src="/python/fluent-python/chapter-14/django_view.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture><figcaption class="caption">UML Class Diagram for the <code>django.views.generic</code> module.</figcaption> </figure> </div> </div> <dl> <dt>Class <code>TemplateView</code><sup id="fnref:django__templateview" role="doc-noteref"><a href="#fn:django__templateview" class="footnote" rel="footnote">9</a></sup> </dt> <dd>A class that renders a template. The class <code>View</code>, along with the mixin classes <code>TemplateResponseMixin</code> and <code>ContextMixin</code>, generates this class. The MRO of the class <code>TemplateView</code> is the following list of classes. <ol> <li> <code>TemplateView</code><sup id="fnref:django__templateview:1" role="doc-noteref"><a href="#fn:django__templateview" class="footnote" rel="footnote">9</a></sup> </li> <li> <code>TemplateResponseMixin</code><sup id="fnref:django__templateresponsemixin" role="doc-noteref"><a href="#fn:django__templateresponsemixin" class="footnote" rel="footnote">10</a></sup> </li> <li> <code>ContextMixin</code><sup id="fnref:django__contextmixin" role="doc-noteref"><a href="#fn:django__contextmixin" class="footnote" rel="footnote">11</a></sup> </li> <li> <code>View</code><sup id="fnref:django__view" role="doc-noteref"><a href="#fn:django__view" class="footnote" rel="footnote">12</a></sup> </li> </ol> </dd> <dt>Class <code>ListView</code><sup id="fnref:django__listview" role="doc-noteref"><a href="#fn:django__listview" class="footnote" rel="footnote">13</a></sup> </dt> <dd>A class that renders some list of objects. The class <code>View</code>, along with some mixin classes, generates this class. The MRO of the class <code>ListView</code> is the following list of classes. <ol> <li> <code>ListView</code><sup id="fnref:django__listview:1" role="doc-noteref"><a href="#fn:django__listview" class="footnote" rel="footnote">13</a></sup> </li> <li> <code>MultipleObjectTemplateResponseMixin</code><sup id="fnref:django__multipleobjecttemplateresponsemixin" role="doc-noteref"><a href="#fn:django__multipleobjecttemplateresponsemixin" class="footnote" rel="footnote">14</a></sup> </li> <li> <code>TemplateResponseMixin</code><sup id="fnref:django__templateresponsemixin:1" role="doc-noteref"><a href="#fn:django__templateresponsemixin" class="footnote" rel="footnote">10</a></sup> </li> <li> <code>BaseListView</code><sup id="fnref:django__baselistview" role="doc-noteref"><a href="#fn:django__baselistview" class="footnote" rel="footnote">15</a></sup> </li> <li> <code>MultipleObjectMixin</code><sup id="fnref:django__multipleobjectmixin" role="doc-noteref"><a href="#fn:django__multipleobjectmixin" class="footnote" rel="footnote">16</a></sup> </li> <li> <code>ContextMixin</code><sup id="fnref:django__contextmixin:1" role="doc-noteref"><a href="#fn:django__contextmixin" class="footnote" rel="footnote">11</a></sup> </li> <li> <code>View</code><sup id="fnref:django__view:1" role="doc-noteref"><a href="#fn:django__view" class="footnote" rel="footnote">12</a></sup> </li> </ol> </dd> </dl> <h3 id="multiple-inheritance-in-tkinter">Multiple Inheritance in Tkinter</h3> <h2 id="coping-with-inheritance">Coping with Inheritance</h2> <p>There is still no general theory about inheritance that can guide practicing programmers. It is easy to create incomprehensible designs using inheritance, even without multiple inheritance. The following tips are to avoid incomprehensible class designs.</p> <h3 id="favor-object-composition-over-class-inheritance">Favor Object Composition over Class Inheritance</h3> <p>The subtitle of this chapter, âFavor Object Composition over Class Inheritanceâ, is from the book <em>Design Patterns</em><sup id="fnref:book__designpatterns" role="doc-noteref"><a href="#fn:book__designpatterns" class="footnote" rel="footnote">17</a></sup>.</p> <p>The two most common techniques for reusing functionality in object-oriented systems are the following:</p> <ol> <li>Class inheritance<sup id="fnref:blog__relationships_inheritance" role="doc-noteref"><a href="#fn:blog__relationships_inheritance" class="footnote" rel="footnote">18</a></sup> (often referred to as <strong>white-box reuse</strong>)</li> <li>Object composition<sup id="fnref:blog__relationships_composition" role="doc-noteref"><a href="#fn:blog__relationships_composition" class="footnote" rel="footnote">19</a></sup> (often referred to as <strong>black-box reuse</strong>)</li> </ol> <p>Inheritance and composition each have their advantages and disadvantages.</p> <ul> <li> <strong>Advantages of Inheritance</strong> <ol> <li>Inheritance is easy to understand because inheritance is defined statically during compile-time.</li> <li>Inheritance is easy to use.</li> <li>Using method overriding makes it easier to modify the implementation being reused in inheritance.</li> </ol> </li> <li> <strong>Disadvantages of Inheritance</strong> <ol> <li>Implementations of inheritance cannot be changed at run-time because inheritance is defined at compile-time.</li> <li>Inheritance reveals the details of implementation of its parent class. In other words, it can be said that âinheritance breaks encapsulationâ.</li> <li>The implementation of a subclass becomes tightly coupled with the implementation of its parent class. This may cause any changes in the implementation of the parent class to require changes in the subclass.</li> <li>The above implementation dependencies can cause problems when reusing a subclass. When these problems occur, the parent class may need to be rewritten or replaced, which causes issues when reusing a subclass. <ul> <li>it is possible to overcome this issue by using abstract base classes.</li> </ul> </li> </ol> </li> <li> <strong>Advantages of Composition</strong> <ol> <li>When using composition, objects generated from other classes are accessed solely through their well-designed interfaces. This does not break the encapsulation of class design.</li> <li>Objects that are involved in composition are accessed through their interface, which reduces implementation dependencies.</li> <li>Composition is defined dynamically at runtime by acquiring objects from other classes. Therefore, objects that are involved in composition can be replaced at runtime by other objects with the same type or objects that have the same properties and methods.</li> <li>Composition helps to keep each class encapsulated and class hierarchies simple.</li> </ol> </li> <li> <strong>Disadvantages of Composition</strong> <ol> <li>Composition requires objects generated from other classes with carefully designed interfaces.</li> <li>Composition requires objects generated dynamically from other classes, and this creates interdependencies among these objects, making the behavior of the system dependent on them.</li> </ol> </li> </ul> <p>To sum up, favoring composition<sup id="fnref:blog__relationships_composition:1" role="doc-noteref"><a href="#fn:blog__relationships_composition" class="footnote" rel="footnote">19</a></sup> over class inheritance is desirable for class designs. The most efficient and desirable class design is to obtain all the required functionality by assembling existing components using composition. Inheritance must be used only when the required functionality cannot be implemented by using composition of existing components.</p> <h4 id="delegation-in-class-design"><em>Delegation in Class Design</em></h4> <p>Delegation can be used for utilizing composition. In class design, delegation is a design pattern where an object passes on responsibilities for certain tasks to another object. It allows for better separation of concerns, promotes code reusability, and makes the class design more flexible and maintainable. The key idea is that instead of a class directly implementing certain functionalities, it delegates those tasks to other classes that specialize in handling them.</p> <p>Letâs illustrate this concept with a simple example in Python. Suppose we have a <code>PrintFormatter</code> class that formats and prints data, but we want it to be able to use different printing strategies. Instead of embedding the printing strategy within the <code>PrintFormatter</code> class, weâll delegate the printing responsibility to other classes representing different printing strategies.</p> <pre><code class="language-python">import abc

# The base abstract class for the printing strategy
class PrintStrategy(abc.ABC):
    @abc.abstractmethod
    def print_data(self, data):
        pass

# Concrete implementation of PrintStrategy using plain print
class PlainTextStrategy(PrintStrategy):
    def print_data(self, data):
        print("Plain Text:", data)

# Concrete implementation of PrintStrategy using a fancy printer
class FancyTextStrategy(PrintStrategy):
    def print_data(self, data):
        print("Fancy Text: ~~~", data, "~~~")

# The main PrintFormatter class that delegates printing to the chosen strategy
class PrintFormatter:
    def __init__(self, strategy):
        self.strategy = strategy

    def format_and_print(self, data):
        formatted_data = self._format_data(data)
        self.strategy.print_data(formatted_data)

    def _format_data(self, data):
        # Perform any necessary formatting here
        return str(data).upper()

# Usage example
data = "hello, delegation!"

# Using the PlainTextStrategy
plain_strategy = PlainTextStrategy()
formatter = PrintFormatter(plain_strategy)
formatter.format_and_print(data)  # Output: Plain Text: HELLO, DELEGATION!

# Using the FancyTextStrategy
fancy_strategy = FancyTextStrategy()
formatter = PrintFormatter(fancy_strategy)
formatter.format_and_print(data)  # Output: Fancy Text: ~~~ HELLO, DELEGATION! ~~~
</code></pre> <p>In this example, <code>PrintFormatter</code> delegates the responsibility of actually printing the data to the <code>PrintStrategy</code> classes (<code>PlainTextStrategy</code> and <code>FancyTextStrategy</code>). By doing this, we can easily switch between different printing behaviors without modifying the <code>PrintFormatter</code> class itself.</p> <p>Delegation is an essential principle in class design, and it can be used in various contexts to enhance code modularity and maintainability. It allows for a more flexible and extensible codebase, as well as better adherence to the Single Responsibility Principle (SRP) in object-oriented design.</p> <h3 id="understand-why-inheritance-is-used-in-each-case">Understand Why Inheritance Is Used in Each Case</h3> <p>When we plan to use multiple inheritance, it is important to check the reasons why subclassing or inheritance is needed in each cases. The common reasons are:</p> <ol> <li>Inheritance of an interface creates a subtype. This means âis-aâ relationship. This can be done with abstract base classes. <ul> <li>Interface inheritance should use only ABCs as base classes.</li> </ul> </li> <li>Inheritance allows us to avoid implimentation code duplication. Mixin classes can help with this. <ul> <li>This should be replaced by composition and delegation, if possible.</li> </ul> </li> </ol> <h3 id="make-interfaces-explicit-with-abcs">Make Interfaces Explicit with ABCs</h3> <ul> <li>When designing a class to define an interface, the class should be an explicit ABC or a <code>typing.Protocol</code> subclass.</li> <li>An ABC should subclass only <code>abc.ABC</code> or other ABCs.</li> <li>Multiple inheritance of ABCs is possible.</li> </ul> <h3 id="use-explicit-mixins-for-code-reuse">Use Explicit Mixins for Code Reuse</h3> <p>The followings are tips for building mixin classes.</p> <ul> <li>A class that is designed to provide additional method implementation for code reuse by multiple subclasses without an âis-aâ relationship should be an explicit mixin class.</li> <li>Mixin classes does not define a new type and should not be instantiated.</li> <li>Mixin classes provides additional method implementations.</li> <li>Mixin classes bundles a few and very closely related methods for providing a single specific additional functionality.</li> <li>Mixin classes should avoid keeping any internal state or properties.</li> <li>It is recommended to use <code>Mixin</code> suffix for the mixin class name to annotate the mixin class. <ul> <li>There is no function for annotating mixin class in Python.</li> </ul> </li> </ul> <h3 id="provide-aggregate-classes-to-users">Provide Aggregate Classes to Users</h3> <p>A class that is constructed primarily by inheriting from mixin classes and does not add its own structure or behavior is called an <em>aggregate class</em><sup id="fnref:book__OOADA_aggregate_class" role="doc-noteref"><a href="#fn:book__OOADA_aggregate_class" class="footnote" rel="footnote">20</a></sup>.</p> <p>For example, the following implementation of the class <code>ListView</code> of Django can be specified as an aggregate class. The body of the class <code>ListView</code> is empty but the class offers useful services.</p> <p>Note that aggregate classes donât have to be completely empty, but they are often empty.</p> <div class="embed-github-src" repo="django/django" branch="b64db05b9cedd96905d637a2d824cbbf428e40e7" path="django/views/generic/list.py" language="python" line="194-198"></div> <h3 id="subclass-only-classes-designed-for-subclassing">Subclass Only Classes Designed for Subclassing</h3> <p>Subclassing any complex class and overriding its methods can cause bugs because the methods of the superclass may not be designed to be overridden in the subclass.</p> <p>To overcome this problem, the following approaches are helpful.</p> <ol> <li>Avoid methods overriding.</li> <li>Only subclass classes that are designed to be easily extended.</li> <li>Subclass in a manner consistent with how they were designed to be extended.</li> </ol> <p>To confirm that a class is designed to be extended by subclass or not, the following approaches are helpful.</p> <ol> <li>Check documentation or docstrings or comments in codes.</li> <li>Check if a class, method, variable or attribute is decorated with the <code>@final</code> decorator<sup id="fnref:pythonorg__typing_final_decorator" role="doc-noteref"><a href="#fn:pythonorg__typing_final_decorator" class="footnote" rel="footnote">21</a></sup> or annotated with the <code>Final</code> annotation<sup id="fnref:pythonorg__typing_final_annotation" role="doc-noteref"><a href="#fn:pythonorg__typing_final_annotation" class="footnote" rel="footnote">22</a></sup> which was introduced in PEP 591 <sup id="fnref:pythonorg__PEP591" role="doc-noteref"><a href="#fn:pythonorg__PEP591" class="footnote" rel="footnote">23</a></sup> <ul> <li>If a class decorated with the <code>@final</code> decorator, it should not be subclassed.</li> <li>If a method decorated with the <code>@final</code> decorator, it should not be overridden.</li> <li>If a variable or attribute annotated with the <code>Final</code> annotation, it should not be reassigned.</li> </ul> </li> </ol> <h3 id="avoid-subclassing-from-concrete-classes">Avoid Subclassing from Concrete Classes</h3> <p>Subclassing concrete classes is more dangerous than subclassing ABCs and mixin classes because</p> <ol> <li>instances of concrete classes usually have internal state that can easily be corrupted when you override methods that depend on that state.</li> <li>Even if your methods cooperate by calling <code>super()</code>, and the internal state is held in private attributes using the <code>__x</code> syntax, there are still countless ways a method override can introduce bugs.</li> </ol> <p>The following stratagies for subclassing are helpful.</p> <ol> <li>All non-leaf classes should be abstract.</li> <li>Only abstract classes should be subclassed.</li> <li>If you must use subclassing for code reuse, then the code intended for reuse should be in mixin methods of ABCs or in explicitly named mixin classes.</li> </ol> <h2 id="chapter-summary">Chapter Summary</h2> <ul> <li> <strong>The <code>super()</code> Function</strong> <ul> <li>The recommendation of <code>super()</code> function in the context of single inheritance</li> </ul> </li> <li> <strong>Subclassing Built-In Types Is Tricky</strong> <ul> <li>Native methods of built-in types implemented in C do not call overridden methods in subclasses, except in very few special cases.</li> <li>It is strongly recommended inherit <code>UserList</code>, <code>UserDict</code>, or <code>UserString</code> instead of <code>list</code>, <code>dict</code>, or <code>str</code> type.</li> <li>These <code>UserXxxx</code> types are all defined in the collections module, which actually wrap the corresponding built-in types and delegate operations to them.</li> <li>If the desired behavior is very different from what the built-ins offer, it may be easier to subclass the appropriate ABC from <code>collections.abc</code> and write your own implementation.</li> </ul> </li> <li> <strong>Multiple Inheritance and Method Resolution Order</strong> <ul> <li>When using multiple inheritance, method resolution order(MRO) may be complex.</li> </ul> </li> <li> <strong>Method Resolution Order</strong> <ul> <li>Method Resolution Order(MRO) is stored in <code>__mro__</code> class attribute.</li> <li>The MRO is calculated by C3 algorithm.</li> <li>The MRO determines the activation order of a method that has an implementation that calls <code>super()</code>.</li> <li>Cooperative method is a method calls <code>super()</code>. Cooperative methods enable cooperative multiple inheritance.</li> <li>A non-cooperative method can be the cause of subtle bugs.</li> <li>Python is a dynamic language, so interaction of <code>super()</code> with the MRO is also dynamic.</li> </ul> </li> <li> <strong>Mixin Classes</strong> <ul> <li>A Mixin class is a class that does not provide all functionality for a concrete object but only adds the behavior of child or sibling classes.</li> <li>The mixin class is designed to be subclassed along with at least one other class in a multiple inheritance arrangement.</li> </ul> </li> <li> <strong>Multiple Inheritance in the Real World</strong> <ul> <li>The following examples are described in this chapter. <ul> <li><code>collections.abc</code></li> <li> <code>ThreadingMixIn</code> and <code>ForkingMixIn</code> in <code>http.server</code> package</li> <li>Django Generic Views Mixins</li> </ul> </li> </ul> </li> <li> <strong>Coping with Inheritance</strong> <ul> <li>Favor Object Composition over Class Inheritance</li> <li>Understand Why Inheritance Is Used in Each Case</li> <li>Make Interfaces Explicit with ABCs</li> <li>Use Explicit Mixins for Code Reuse</li> <li>Provide Aggregate Classes to Users</li> <li>Subclass Only Classes Designed for Subclassing</li> <li>Avoid Subclassing from Concrete Classes <ul> <li>Rejecting inheritanceâeven single inheritanceâis a modern trend.</li> </ul> </li> </ul> </li> </ul> <h2 id="links">Links</h2> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:pythonorg__builtinfunctions_super" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/functions.html#super" rel="external nofollow noopener" target="_blank">Built-in Functions : <em><code>class</code></em> <strong><code>super</code></strong></a>Â <a href="#fnref:pythonorg__builtinfunctions_super" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__colletions_ordereddict" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" rel="external nofollow noopener" target="_blank"><code>collections</code> â Container datatypes : <code>class collections.OrderedDict</code></a>Â <a href="#fnref:pythonorg__colletions_ordereddict" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__colletions_ordereddict_move_to_end" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/collections.html#collections.OrderedDict.move_to_end" rel="external nofollow noopener" target="_blank"><code>collections</code> â Container datatypes : <code>collections.OrderedDict.move_to_end()</code></a>Â <a href="#fnref:pythonorg__colletions_ordereddict_move_to_end" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:blog__c3_method_resolution_order" role="doc-endnote"> <p><a href="../../standard-library/c3_method_resolution_order/">C3 Method Resolution Order</a>Â <a href="#fnref:blog__c3_method_resolution_order" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__collections_abc" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/collections.abc.html" rel="external nofollow noopener" target="_blank"><code>collections.abc</code> â Abstract Base Classes for Containers</a>Â <a href="#fnref:pythonorg__collections_abc" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:pythonorg__collections_abc:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:github__implementation_userdict" role="doc-endnote"> <p><a href="https://github.com/python/cpython/blob/8ece98a7e418c3c68a4c61bc47a2d0931b59a889/Lib/collections/__init__.py#L1084" rel="external nofollow noopener" target="_blank">Implementation of <code>class UserDict</code></a>Â <a href="#fnref:github__implementation_userdict" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__http_server" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/http.server.html" rel="external nofollow noopener" target="_blank"><code>http.server</code> â HTTP servers</a>Â <a href="#fnref:pythonorg__http_server" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__os_fork" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/os.html#os.fork" rel="external nofollow noopener" target="_blank"><code>os</code> â Miscellaneous operating system interfaces : <code>os.fork()</code></a>Â <a href="#fnref:pythonorg__os_fork" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:django__templateview" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.base/TemplateView/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>TemplateView</code></a>Â <a href="#fnref:django__templateview" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:django__templateview:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:django__templateresponsemixin" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.base/TemplateResponseMixin/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>TemplateResponseMixin</code></a>Â <a href="#fnref:django__templateresponsemixin" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:django__templateresponsemixin:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:django__contextmixin" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.base/ContextMixin/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>ContextMixin</code></a>Â <a href="#fnref:django__contextmixin" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:django__contextmixin:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:django__view" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.base/View/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>View</code></a>Â <a href="#fnref:django__view" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:django__view:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:django__listview" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.list/ListView/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>ListView</code></a>Â <a href="#fnref:django__listview" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:django__listview:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:django__multipleobjecttemplateresponsemixin" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.list/MultipleObjectTemplateResponseMixin/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>MultipleObjectTemplateResponseMixin</code></a>Â <a href="#fnref:django__multipleobjecttemplateresponsemixin" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:django__baselistview" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.list/BaseListView/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>BaseListView</code></a>Â <a href="#fnref:django__baselistview" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:django__multipleobjectmixin" role="doc-endnote"> <p><a href="https://ccbv.co.uk/projects/Django/4.2/django.views.generic.list/MultipleObjectMixin/" rel="external nofollow noopener" target="_blank">Django Classy Class-Based Views â Class <code>MultipleObjectMixin</code></a>Â <a href="#fnref:django__multipleobjectmixin" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:book__designpatterns" role="doc-endnote"> <p><a href="https://en.wikipedia.org/wiki/Design_Patterns" rel="external nofollow noopener" target="_blank">Wikipedia : Design Patterns: Elements of Resuable Object-Oriented Software (1994)</a>Â <a href="#fnref:book__designpatterns" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:blog__relationships_inheritance" role="doc-endnote"> <p><a href="../../../softwaredesign/uml-diagram/relationships/#generalization">Relationships : Generalization</a>Â <a href="#fnref:blog__relationships_inheritance" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:blog__relationships_composition" role="doc-endnote"> <p><a href="../../../softwaredesign/uml-diagram/relationships/#composition">Relationships : Composition</a>Â <a href="#fnref:blog__relationships_composition" class="reversefootnote" role="doc-backlink">â©</a>Â <a href="#fnref:blog__relationships_composition:1" class="reversefootnote" role="doc-backlink">â©<sup>2</sup></a></p> </li> <li id="fn:book__OOADA_aggregate_class" role="doc-endnote"> <p>Grady Booch et al., <em>Object-Oriented Analysis and Design with Applications</em>, 3rd ed. (Addison-Wesley), p. 109.Â <a href="#fnref:book__OOADA_aggregate_class" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__typing_final_decorator" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/typing.html#typing.final" rel="external nofollow noopener" target="_blank"><code>typing</code> â Support for type hints : <code>@typing.final</code></a>Â <a href="#fnref:pythonorg__typing_final_decorator" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__typing_final_annotation" role="doc-endnote"> <p><a href="https://docs.python.org/3/library/typing.html#typing.Final" rel="external nofollow noopener" target="_blank"><code>typing</code> â Support for type hints : <code>typing.Final</code></a>Â <a href="#fnref:pythonorg__typing_final_annotation" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:pythonorg__PEP591" role="doc-endnote"> <p><a href="https://peps.python.org/pep-0591/" rel="external nofollow noopener" target="_blank">PEP 591 â Adding a final qualifier to typing</a>Â <a href="#fnref:pythonorg__PEP591" class="reversefootnote" role="doc-backlink">â©</a></p> </li> </ol> </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2024 Dongseok Kim. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script> <script>hljs.highlightAll();</script> <script src="//cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.8.0/dist/highlightjs-line-numbers.min.js"></script> <script>hljs.initLineNumbersOnLoad();</script> <script>function append_code_block_header(e){if(!e.className)return;const[t,r]=get_language_and_url(e);r&&(replace_className(e,t),elemCodeBlockHeader=create_elem_code_block_header(r),append_elem_code_block_header_to_previous(e,elemCodeBlockHeader))}function get_language_and_url(e){return e.className.split(/:(.*)/s)}function replace_className(e,t){e.classList.remove(e.className),e.classList.add(t)}function create_elem_code_block_header(e){var t=document.createElement("a");return t.textContent=e,(e.startsWith("http://")||e.startsWith("https://"))&&(t.setAttribute("href",e),t.setAttribute("target","_blank")),t.className="language-plaintext",t}function append_elem_code_block_header_to_previous(e,t){var r=e.parentElement;r.insertBefore(t,r.firstChild),r.classList.add("code-block-header")}function embed_external_source(e){var t=get_url_raw(e),r=get_url_blob(e),n=e.getAttribute("language"),c=get_lines(e),l=c[0],a=c[1];fetch(t).then(function(e){return e.text()}).then(function(t){var c=create_elem_code_block(n,r,t,l,a),o=create_elem_pre_from_code_block(c),_={startFrom:Math.max(l,1)};e.appendChild(o),hljs.highlightBlock(c),hljs.lineNumbersBlock(c,_)})["catch"](function(e){throw e})}function embed_local_source(e){var t=get_url_raw_local(e),r=get_url_blob_local(e),n=e.getAttribute("language"),c=get_lines(e),l=c[0],a=c[1];fetch(t).then(function(e){return e.text()}).then(function(t){var c=create_elem_code_block(n,r,t,l,a),o=create_elem_pre_from_code_block(c);e.appendChild(o),hljs.highlightBlock(c),hljs.lineNumbersBlock(c)})["catch"](function(e){throw e})}function get_url_raw(e){return["https://raw.githubusercontent.com",e.getAttribute("repo"),e.getAttribute("branch"),e.getAttribute("path")].join("/")}function get_url_blob(e){return["https://github.com",e.getAttribute("repo"),"blob",e.getAttribute("branch"),e.getAttribute("path")+get_line_specifier(e)].join("/")}function get_url_raw_local(e){return e.getAttribute("path")}function get_url_blob_local(e){return get_url_raw_local(e)}function get_lines(e){const t=e.getAttribute("line");if(!t)return[0,0];var[r,n]=t.split(/-(.*)/s);return r=parseInt(r),n=parseInt(n),isNaN(r)&&(r=0),isNaN(n)&&(n=0),[r,n]}function get_line_specifier(e){const t=get_lines(e);return 0==t[0]&&0==t[1]?"":(0==t[1]&&t[1],"#L"+String(t[0])+"-L"+String(t[1]))}function create_elem_code_block(e,t,r,n,c){var l=document.createElement("code");return l.className="language-"+e+":"+t,l.textContent=slice_by_line_number(r,n,c),l}function slice_by_line_number(e,t,r){return 0==t&&0==r?e:(0==t&&(t=1),e.split("\n").slice(t-1,r).join("\n"))}function create_elem_pre_from_code_block(e){var t=document.createElement("pre");return t.appendChild(e),append_code_block_header(e),t}const code=document.getElementsByTagName("code");Array.from(code).forEach(append_code_block_header);var divs=document.getElementsByClassName("embed-github-src");Array.prototype.forEach.call(divs,embed_external_source);divs=document.getElementsByClassName("embed-local-src");Array.prototype.forEach.call(divs,embed_local_source);</script> </body> </html>